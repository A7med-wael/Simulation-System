<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Queuing System Simulation</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/font-awesome/css/all.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
<div class="container mt-4">

    <div id="flash-messages-container"></div>

    <section class="row">
        <!-- Controls Section -->
        <div class="col-md-3">
            <div class="card controls">
                <div class="card-header bg-dark text-white"><i class="fas fa-cogs"></i> Controls</div>
                <div class="card-body">
                    <form id="uploadFileForm" enctype="multipart/form-data">
                        <input type="file" class="form-control mb-2" name="file" accept=".csv,.xlsx" required>
                        <button type="button" id="uploadFileButton" class="btn btn-primary w-100 mb-2"><i class="fas fa-upload"></i> Upload Data</button>
                    </form>
                    <form id="simulateForm">
                        <div class="form-check mb-2">
                            <input type="checkbox" class="form-check-input" id="probabilityCheckbox" name="probability_simulation">
                            <label class="form-check-label" for="probabilityCheckbox">Enable Probability Simulation</label>
                        </div>
                        <button type="button" id="simulateButton" class="btn btn-success w-100 mb-2"><i class="fas fa-play"></i> Simulate</button>
                    </form>
                    <button id="downloadDataButton" class="btn btn-info w-100 mb-2"><i class="fas fa-save"></i> Save All</button>
                    <button id="clearDataButton" class="btn btn-danger w-100" data-bs-toggle="modal" data-bs-target="#clearDataModal"><i class="fas fa-trash"></i> Clear All</button>
                </div>
            </div>

            <!-- Current Services -->
            <div class="card my-2 current-services d-none">
                <div class="card-header bg-dark text-white"><i class="fas fa-list"></i> Current Services</div>
                <div class="card-body service-list">
                    <ul class="list-group">
                        <!-- added dynamically -->
                    </ul>
                </div>
            </div>

            <!-- Add New Service Section -->
            <div class="card my-2">
                <div class="card-header bg-dark text-white"><i class="fas fa-plus"></i> Add New Service</div>
                <div class="card-body">
                    <form id="addServiceForm">
                        <div class="mb-2">
                            <label for="service_code" class="form-label">Service Code</label>
                            <input type="text" class="form-control" id="service_code" name="service_code" required>
                        </div>
                        <div class="mb-2">
                            <label for="service_title" class="form-label">Service Title</label>
                            <input type="text" class="form-control" id="service_title" name="service_title" required>
                        </div>
                        <div class="mb-2">
                            <label for="service_duration" class="form-label">Duration (min)</label>
                            <input type="number" class="form-control" id="service_duration" name="service_duration" required>
                        </div>
                        <button type="button" id="addServiceButton" class="btn btn-primary w-100"><i class="fas fa-save"></i> Add Service</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Data Display Section -->
        <div class="col-md-9">
            <!-- Customer Data Table -->
            <div class="card mb-3">
                <div class="card-header bg-dark text-white"><i class="fas fa-users"></i> Customer Data</div>
                <div class="card-body table-container">
                    <table class="table table-striped table-bordered customer-data-table">
                        <thead>
                            <tr>
                                <th>Customer ID</th>
                                <th>Event Type</th>
                                <th>Clock Time</th>
                                <th>Service Code</th>
                                <th>Service Title</th>
                                <th>Service Duration</th>
                                <th>End Time</th>
                                <th class="arrival-prob d-none">Arrival Probability</th>
                                <th class="completion-prob d-none">Completion Probability</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- added dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Chronological Order of Events -->
            <div class="card mb-3">
                <div class="card-header bg-dark text-white"><i class="fas fa-clock"></i> Chronological Order of Events</div>
                <div class="card-body table-container">
                    <table class="table table-striped table-bordered event-data-table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Event Type</th>
                                <th>Customer ID</th>
                                <th>Service</th>
                                <th class="arrival-prob d-none">Arrival Probability</th>
                                <th class="completion-prob d-none">Completion Probability</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Add event rows dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- System State Graph -->
            <div class="card mb-1">
                <div class="card-header bg-dark text-white">
                    <i class="fas fa-chart-line"></i> System State Graph
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="card-body">
                            <!-- Tab navigation -->
                            <ul class="nav nav-tabs" id="plotTab" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="arrival-tab" data-bs-toggle="tab" data-bs-target="#arrival" type="button" role="tab" aria-controls="arrival" aria-selected="true">
                                        Arrival Plot
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="system_state-tab" data-bs-toggle="tab" data-bs-target="#system_state" type="button" role="tab" aria-controls="system_state" aria-selected="false">
                                        System State Plot
                                    </button>
                                </li>
                            </ul>

                            <!-- Tab content -->
                            <div class="tab-content mt-3" id="plotTabContent">
                                <!-- First Tab -->
                                <div class="tab-pane fade show active" id="arrival" role="tabpanel" aria-labelledby="arrival-tab">
                                    <div class="plot-container">
                                        <img id="arrival_plot" src="/arrival_plot.png" alt="System State Graph">
                                    </div>
                                </div>

                                <!-- Second Tab -->
                                <div class="tab-pane fade" id="system_state" role="tabpanel" aria-labelledby="system_state-tab">
                                    <div class="plot-container">
                                        <img id="system_state_plot" src="/customers_system_plot.png" alt="System State Over Time">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- Clear Data Confirmation Modal -->
<div class="modal fade" id="clearDataModal" tabindex="-1" aria-labelledby="clearDataModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="clearDataModalLabel">Confirm Clear Data</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to clear all data? This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmClearDataButton">Clear Data</button>
            </div>
        </div>
    </div>
</div>

    <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/font-awesome/js/all.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>

</body>
</html>
